# 车辆多任务感知系统

本项目为中山大学智能工程学院大三课程深度学习编程任务。构建了一个基于计算机视觉的车辆多任务感知系统。项目涵盖了从基础模型评估、车型分类、车牌识别到车速估计的完整技术链路，并集成了一个基于 Streamlit 的可视化 Web 应用。

## 项目结构概览

项目分为 5 个主要模块，每个模块均有独立的文档和实现代码。

| **模块目录**                                             | **任务描述**               | **核心技术/模型**                             |
| -------------------------------------------------------- | -------------------------- | --------------------------------------------- |
| **[📂 task0](./task0)**   | **YOLO 模型性能评估**      | YOLOv8/v11 Zero-shot 评估, mAP/FPS 分析       |
| **[📂 task1](./task1)**   | **车型识别 (BIT-Vehicle)** | YOLOv11 (端到端) vs. ResNet/Swin (分类器)     |
| **[📂 task2](./task2)**   | **车牌识别 (CCPD)**        | YOLO-Pose / YOLOv8 + CRNN / PP-OCRv5 / LPRNet |
| **[📂 task3](./task3)**   | **车速识别**               | 单目视觉, 单应性变换, 卡尔曼滤波, YOLOv11     |
| **[📂 UI_App](./UI_App)** | **可视化演示系统**         | Streamlit, 集成上述功能                       |

## 模块详细介绍

### 1. [Task 0: YOLO 模型性能评估](./task0)

针对车辆检测场景，在不微调的情况下，对官方预训练的 **YOLOv8** 和 **YOLOv11** 全系列模型（n/s/m/l/x）进行 Zero-shot 性能评估。

- **功能**：自动过滤 COCO 非车辆类别，生成 mAP、推理速度对比图及热力图。
- **输出**：详细的性能评估报告 (`performance_report.txt`) 和可视化图表。

### 2. [Task 1: 车型识别](./task1)

基于 **BIT-Vehicle 数据集**，实现了两种车型识别方案：

- **方案 A (端到端检测)**：使用 YOLOv11-large 进行多类别目标检测 (mAP@0.5: 97.73%)。
- **方案 B (级联分类)**：检测后裁剪，使用 ResNet50/Swin-T 等分类器进行细粒度分类 (Accuracy: 97.80%)。
- **特点**：提供了数据集格式转换脚本 (`mat_to_yolo`, `yolo_to_cls`) 及完整的训练评估代码。

### 3. [Task 2: 车牌识别方案对比](./task2)

基于 **CCPD 数据集**，探索了三种不同的技术路线（由三位成员分别实现）：

| **方案**     | **技术栈**             | **特点**                            | **场景推荐**          |
| ------------ | ---------------------- | ----------------------------------- | --------------------- |
| **Member 1** | **YOLOv8-Pose + CRNN** | **最佳综合性能** (全字匹配率 98.7%) | 复杂场景、高精度需求  |
| **Member 2** | **PP-OCRv5**           | **最佳识别上限** (仅识别率 99.3%)   | 追求极致OCR速度与精度 |
| **Member 3** | **YOLOv8 + LPRNet**    | **轻量级基线** (全字匹配率 85.1%)   | 资源受限环境          |

> 详情请参阅 `task2` 目录下的汇总文档及各子项目文档。

### 4. [Task 3: 监控场景下的车速识别](./task3)

基于单目相机的车辆速度检测系统，适用于高速公路和城市道路。

- **核心算法**：相机标定 (单应性变换) + YOLOv11l 车辆检测 + 多目标追踪 + 卡尔曼滤波平滑。
- **功能**：支持交互式标定（通过车道线/斑马线标定真实距离），实时计算并显示车辆速度。

### 5. [UI_App: 综合演示系统](./UI_App)

基于 **Streamlit** 开发的 Web 界面，集成了上述核心功能，支持图片和视频输入。

**功能集成**：

- **车型识别**：识别 Bus, Truck, SUV, Sedan 等类型。
- **车牌识别**：检测并识别车牌号码。
- **车速识别**：提供交互式标定界面，估算视频中车辆速度。

## 环境配置与运行指南

**关于具体的环境依赖安装、模型权重下载以及代码运行方式，请详细参考各子目录下的 `README.md` 文档。**

- [查看 Task 0 文档](./task0/README.md)
- [查看 Task 1 文档](./task1/README.md)
- [查看 Task 2 文档](./task2/README.md)
- [查看 Task 3 文档](./task3/README.md)
- [查看 UI App 文档](./UI_App/README.md)

## 引用与致谢

- **Datasets**: CCPD (Chinese City Parking Dataset), BIT-Vehicle Dataset.
- **Models**: YOLOv8/v11 by Ultralytics, PaddleOCR by PaddlePaddle, LPRNet, CRNN.
- **References**: 详见各子任务文件夹内的 README 文档。
